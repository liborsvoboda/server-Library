$.History?window.console.warn("$.History has already been defined..."):($.History={options:{debug:!1},timer:null,state:"",$window:null,$iframe:null,handlers:{generic:[],specific:{}},extractHash:function(e){return e.replace(/^[^#]*#/,"").replace(/^#+|#+$/,"")},getState:function(){return $.History.state},setState:function(e){var t=$.History;return e=t.extractHash(e),t.state=e,t.state},getHash:function(){return $.History.extractHash(window.location.hash||location.hash)},setHash:function(e){return e=$.History.extractHash(e),void 0!==window.location.hash?window.location.hash!==e&&(window.location.hash=e):location.hash!==e&&(location.hash=e),e},go:function(e){var t=$.History,r=(e=t.extractHash(e),t.getHash()),n=t.getState();return e!==r?t.setHash(e):(e!==n&&t.setState(e),t.trigger()),!0},hashchange:function(e,t,r){var n=$.History;if(n.nativeSupport||n.notSupportTrigger)n.firedFirstTime=!0,n.notSupportTrigger=!1;else if(n.nativeSupport=!0,n.timer&&clearInterval(n.timer),n.firedFirstTime)return!1;var o=n.getHash();return n.go(o),!0},bind:function(e,t){var r=$.History;return t?(void 0===r.handlers.specific[e]&&(r.handlers.specific[e]=[]),r.handlers.specific[e].push(t)):r.handlers.generic.push(t=e),!0},trigger:function(e){var t,r,n,o=$.History;if(void 0===e&&(e=o.getState()),void 0!==o.handlers.specific[e])for(t=0,r=(n=o.handlers.specific[e]).length;t<r;++t)(0,n[t])(e);for(t=0,r=(n=o.handlers.generic).length;t<r;++t)(0,n[t])(e);return!0},construct:function(){var e=$.History;return $(document).ready(function(){e.domReady()}),!0},configure:function(e){var t=$.History;return t.options=$.extend(t.options,e),!0},domReadied:!1,domReady:function(){var e=$.History;if(!e.domRedied)return e.domRedied=!0,e.$window=$(window),e.$window.bind("hashchange",this.hashchange),e.nativeSupport=e.nativeSupport(),setTimeout(e.hashchangeLoader,200),!0},nativeSupport:function(e){var t=(e=e||$.browser).version,t=parseInt(t,10),r=!1;return e.msie&&8<=t||e.webkit&&528<=t?r=!0:e.mozilla?(1<browserVersionPartsOne||1===browserVersionPartsOne&&(9<browserVersionPartsTwo||9===browserVersionPartsTwo&&2<=browserVersionPartsThree))&&(r=!0):e.opera&&(10<browserVersionPartsOne||10===browserVersionPartsOne&&60<=browserVersionPartsTwo)&&(r=!0),r},hashchangeLoader:function(){var n,e,o=$.History;return o.nativeSupport?o.getHash()&&o.$window.trigger("hashchange"):(e=$.browser.msie?(o.$iframe=$('<iframe id="jquery-history-iframe" style="display: none;"></iframe>').prependTo(document.body)[0],o.$iframe.contentWindow.document.open(),o.$iframe.contentWindow.document.close(),n=!1,function(){var e=o.getHash(),t=o.getState(),r=o.extractHash(o.$iframe.contentWindow.document.location.hash);t!==e?(n||(o.$iframe.contentWindow.document.open(),o.$iframe.contentWindow.document.close(),o.$iframe.contentWindow.document.location.hash=e),n=!1,o.notSupportTrigger=!0,o.$window.trigger("hashchange")):t!==r&&(n=!0,o.setHash(r))}):function(){var e=o.getHash();o.getState()!==e&&(o.notSupportTrigger=!0,o.$window.trigger("hashchange"))},o.timer=setInterval(e,2e3)),!0}},$.History.construct())